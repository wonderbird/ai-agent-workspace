---
description: Use when an unexpected obstacle prevents progress
alwaysApply: false
---
# Remediation Protocol

This protocol must be activated immediately upon discovering any unexpected obstacle that prevents progress.

## Examples of Obstacles

- An unexpected test failure.
- A regression in functionality.
- A drop in code quality metrics (e.g., surviving mutants).
- An error or incorrect behavior from a command-line tool.

## Principle: One Obstacle at a Time

All work must be reduced to resolving a single, isolated obstacle. Attempting to solve multiple issues simultaneously is strictly forbidden.

## Workflow

1. **STOP and Document:** Immediately stop the current primary task. Update the memory bank (`activeContext.md` and `progress.md`) to reflect the exact obstacle encountered (e.g., "Mutation test revealed 2 survivors. Pausing refactoring to address them." or "Tooling error: `dotnet stryker` command failed. Pausing mutant analysis to fix the command.").

2. **Isolate and Prioritize:**
    - List all identified obstacles (e.g., "Mutant A survived," "Mutant B survived," "Stryker command syntax is wrong").
    - Select **only the first obstacle** from the list. The remaining obstacles must be ignored until the first is fully resolved.

3. **Execute a Single Fix Cycle:**
    - **Hypothesize:** Formulate a specific, testable hypothesis for the cause of the single obstacle. (e.g., "The mutant survives because there is no test for `SellIn = 1`", or "The Stryker command fails because the reporter syntax is incorrect. The `--help` flag suggests I should use two `--reporter` flags instead of a list.").
    - **Test Hypothesis (Red/Verification):** Create the minimal change required to test the hypothesis.
        - For a **code bug**, this is a minimal failing test (the "Red" step).
        - For a **tooling bug**, this is a minimal command execution to see if the new syntax works.
    - **Verify Outcome:** Run the test or command.
        - If it behaves as expected (e.g., the test fails, the command succeeds), the hypothesis is likely correct. Proceed to the next step.
        - If it does not behave as expected, the hypothesis is wrong. Revert the change and return to the "Hypothesize" step to formulate a new one.
    - **Implement Fix (Green):**
        - For a **code bug**, write the minimal production code to make the test pass.
        - For a **tooling bug**, the fix was already verified in the previous step. No further action is needed.
    - **Verify Fix:** Run the relevant tests or commands to confirm the obstacle is resolved and no regressions were introduced.

4. **Commit and Document:** Commit the change with a message that clearly states which specific obstacle was resolved (e.g., `test: kill mutant #14 in UpdateNormalItem` or `chore: fix stryker reporter command syntax`). Update the memory bank to reflect that one obstacle has been resolved.

5. **Repeat or Resume:**
    - If there are more obstacles in the list from step 2, return to step 2 and select the next one.
    - If all obstacles are resolved, announce that the remediation is complete and resume the original, primary task.

## Happiness

ðŸ’£
